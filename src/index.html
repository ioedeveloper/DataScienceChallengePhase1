<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>DataScienceChallengePhase1</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-site-verification" content="BAE-_c0TyJwPvpTYnhutxzcyT2Idgem9pLI8kA5OCOg" />
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="assets/css/bootstrap.min.css" rel="stylesheet">
	<link href="assets/css/font-awesome.min.css" rel="stylesheet">
	<link href="assets/css/datepicker3.css" rel="stylesheet">
	<link href="assets/css/styles.css" rel="stylesheet">
	
	<!--Custom Font-->
	<link href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
	<!--[if lt IE 9]>
	<script src="js/html5shiv.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->
</head>
<body>
  <app-root></app-root>
  <script src="assets/js/jquery-1.11.1.min.js"></script>
  <script src="assets/js/bootstrap.min.js"></script>
  <script src="assets/js/chart.min.js"></script>
  <script src="assets/js/chart-data.js"></script>
  <script src="assets/js/easypiechart.js"></script>
  <script src="assets/js/easypiechart-data.js"></script>
  <script src="assets/js/bootstrap-datepicker.js"></script>
  <script src="assets/js/custom.js"></script>

  <script>
    function getRandomColor() {
      var letters = '0123456789ABCDEF';
      var color = '#';
      for (var i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * 16)];
      }
      return color;
    }

  window.onload = function () {

    //Make ajax request to fetch analyzed data.
    var xhttp = new XMLHttpRequest();
      var url = "https://sheets.googleapis.com/v4/spreadsheets/1lq6AcmAbkOWidxiN_9gb1LdGAczeOKjbU_r3QpArbu8/values/Analysis?key=AIzaSyDBKRDMfrBz9L4S0V-AIKDlCWhK7mIEHV0";
      xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          let analysis = JSON.parse(this.responseText);
          console.log(analysis);
          $("#countresponses").html(analysis.values[0][2]);
          $("#countcountries").html(analysis.values[1][2]);
          let total = parseInt(analysis.values[2][2]) + parseInt(analysis.values[3][2]) + parseInt(analysis.values[4][2]) + parseInt(analysis.values[5][2]) + parseInt(analysis.values[6][2]) + parseInt(analysis.values[7][2]) + parseInt(analysis.values[8][2]) + parseInt(analysis.values[9][2]);
          let listvalues = [(parseInt(analysis.values[2][2])/total)*100, (parseInt(analysis.values[3][2])/total)*100, (parseInt(analysis.values[4][2])/total)*100,(parseInt(analysis.values[5][2])/total)*100,(parseInt(analysis.values[6][2])/total)*100,(parseInt(analysis.values[7][2])/total)*100,(parseInt(analysis.values[8][2])/total)*100,(parseInt(analysis.values[9][2])/total)*100];
          let pieData = [];
          let count = 2;
          for(let val in listvalues){
            let color = getRandomColor()
            let option = {
              value: Math.round(listvalues[val]),
              color:color,
              highlight: color,
              label: analysis.values[count][0]
            }
            pieData.push(option);
            $("#keys").append(`<div style="display:inline-block; padding-right: 10px; margin-top: 10px padding-bottom:10px;">
                              <i class="fa fa-square" style="color:`+color+`"></i><span> `+analysis.values[count][0]+`</span>
                              </div>`);
            count++;
          };
          let chart4 = document.getElementById("pie-chart").getContext("2d");
            window.myPie = new Chart(chart4).Pie(pieData, {
            responsive: true,
            segmentShowStroke: true
          });
        }
      };
      xhttp.open("GET", url, true);
      xhttp.send();
  var chart1 = document.getElementById("line-chart").getContext("2d");
  window.myLine = new Chart(chart1).Line(lineChartData, {
  responsive: true,
  scaleLineColor: "rgba(0,0,0,.2)",
  scaleGridLineColor: "rgba(0,0,0,.05)",
  scaleFontColor: "#c5c7cc"
  });
  var chart2 = document.getElementById("bar-chart").getContext("2d");
  window.myBar = new Chart(chart2).Bar(barChartData, {
  responsive: true,
  scaleLineColor: "rgba(0,0,0,.2)",
  scaleGridLineColor: "rgba(0,0,0,.05)",
  scaleFontColor: "#c5c7cc"
  });
  };
  </script>	
</body>
</html>
